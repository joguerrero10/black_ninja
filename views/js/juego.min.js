let juego={bajarVolumen:function(d){let b=d.getAttribute("volumen");let a=document.querySelectorAll("#sonido ul li");for(let c=0;c<datos.listaSonidos.length;
c++){datos.listaSonidos[c].volume=b;}if(b==0){for(let c=0;c<a.length;c++){a[c].style.opacity=0.5;}}else{if(b==0.3){a[0].style.opacity=1;a[1].style.opacity=1;
a[2].style.opacity=0.5;}else{for(let c=0;c<a.length;c++){a[c].style.opacity=1;}}}},controles:function(){document.querySelector("#izquierda").addEventListener("touchstart",function(a){a.preventDefault();
datos.izquierda=true;});document.querySelector("#izquierda").addEventListener("touchend",function(a){a.preventDefault();datos.izquierda=false;datos.imgJugador.src=datos.stop_left.src;
});document.querySelector("#derecha").addEventListener("touchstart",function(a){a.preventDefault();datos.derecha=true;});document.querySelector("#derecha").addEventListener("touchend",function(a){a.preventDefault();
datos.derecha=false;datos.imgJugador.src=datos.stop_right.src;});document.querySelector("#arriba").addEventListener("touchstart",function(a){a.preventDefault();
datos.salto=true;datos.sSaltoJugador.play();});document.querySelector("#arriba").addEventListener("touchend",function(a){a.preventDefault();datos.salto=false;
});document.querySelector("#disparo").addEventListener("touchstart",function(a){a.preventDefault();datos.disparo=true;datos.disparo_y=datos.jugador_y;datos.movDisparoJugador=0;
datos.imgDisparoJugador.src=datos.imgDisparoJugador.src;datos.disparo_ancho=15;datos.disparo_alto=15;datos.sDisparoJugador.play();});document.querySelector("#disparo").addEventListener("touchend",function(a){a.preventDefault();
datos.disparo=false;});},teclado:function(){document.addEventListener("keydown",juego.oprimir);document.addEventListener("keyup",juego.soltar);},oprimir:function(a){a.preventDefault();
if(a.keyCode==37){datos.izquierda=true;}if(a.keyCode==39){datos.derecha=true;}if(a.keyCode==38){datos.salto=true;datos.sSaltoJugador.play();}if(a.keyCode==32){datos.disparo=true;
datos.disparo_y=datos.jugador_y;datos.movDisparoJugador=0;datos.imgDisparoJugador.src=datos.imgDisparoJugador.src;datos.disparo_ancho=15;datos.disparo_alto=15;
datos.sDisparoJugador.play();}},soltar:function(a){a.preventDefault();if(a.keyCode==37){datos.izquierda=false;datos.imgJugador.src=datos.stop_left.src;
}if(a.keyCode==39){datos.derecha=false;datos.imgJugador.src=datos.stop_right.src;}if(a.keyCode==38){datos.salto=false;}if(a.keyCode==32){datos.disparo=false;
}},tiempo:function(){lienzo.canvas();if(datos.nivel==1){datos.sBackground01.play();datos.sBackground01.loop=true;}if(datos.nivel==2){datos.sBackground02.play();
datos.sBackground02.loop=true;}if(datos.nivel==3){datos.sBackground03.play();datos.sBackground03.loop=true;}if(datos.cicloSprite>=500){datos.cicloSprite=0;
}else{datos.cicloSprite+=20;}for(let f=0;f<=datos.cicloSprite;f+=100){if(datos.cicloSprite>=f){datos.sprite_x=f;}}if(datos.movTrampas<=0){datos.cambioMovTrampas=false;
}if(datos.movTrampas>=100){datos.cambioMovTrampas=true;}if(!datos.cambioMovTrampas){datos.movTrampas++;}else{datos.movTrampas--;}datos.desplazamientoEscenario+=datos.movimiento;
if(datos.desplazamientoEscenario<=datos.limiteEscenario){datos.jugador_x+=datos.movimientoJugador;}for(let f=0;f<datos.plataforma.length;f++){datos.plataforma[f].x+=datos.movimiento;
}for(let f=0;f<datos.posMonedas.length;f++){datos.posMonedas[f].x+=datos.movimiento;}for(let f=0;f<datos.posTrampas.length;f++){datos.posTrampas[f].x+=datos.movimiento;
}for(let f=0;f<datos.posEnemigos.length;f++){datos.posEnemigos[f].x+=datos.movimiento;}for(let f=0;f<datos.posBalasEnemigos.length;f++){datos.posBalasEnemigos[f].x+=datos.movimiento;
}if(datos.izquierda){datos.direccionJugador="izquierda";if(datos.desplazamientoEscenario>=0){datos.movimiento=0;}else{if(datos.desplazamientoEscenario<=datos.limiteEscenario){if(datos.jugador_x<=70){datos.movimiento=datos.velocidad;
}else{datos.movimiento=0;datos.movimientoJugador=-datos.velocidad;}}else{datos.movimiento=datos.velocidad;}}if(datos.gravedad==0){datos.imgJugador.src=datos.run_left.src;
}if(datos.salto&&datos.gravedad==0){datos.imgJugador.src=datos.jump_left.src;}}if(datos.derecha){datos.direccionJugador="derecha";if(datos.desplazamientoEscenario<=datos.limiteEscenario){datos.movimiento=0;
datos.movimientoJugador=datos.velocidad;}else{datos.movimiento=-datos.velocidad;}if(datos.gravedad==0){datos.imgJugador.src=datos.run_right.src;}if(datos.salto&&datos.gravedad==0){datos.imgJugador.src=datos.jump_right.src;
}}if(!datos.izquierda&&!datos.derecha){datos.movimiento=0;datos.movimientoJugador=0;}datos.jugador_y+=datos.gravedad;if(datos.gravedad<datos.limiteGravedad){datos.gravedad+=datos.peso;
}for(let f=0;f<datos.plataforma.length;f++){function c(){if((datos.jugador_y+datos.jugador_alto)<datos.plataforma[f].y){return false;}if(datos.jugador_y>(datos.plataforma[f].y+datos.plataforma[f].alto)){return false;
}if((datos.jugador_x+datos.jugador_ancho)<datos.plataforma[f].x){return false;}if(datos.jugador_x>(datos.plataforma[f].x+datos.plataforma[f].ancho)){return false;
}return true;}c();if(c()&&(datos.jugador_y+datos.jugador_alto)<datos.plataforma[f].y+datos.gravedad){datos.gravedad=0;datos.jugador_y=datos.plataforma[f].y-datos.jugador_alto;
}if(c()&&datos.jugador_y-datos.gravedad>(datos.plataforma[f].y+datos.plataforma[f].alto)){datos.gravedad=1;datos.jugador_y=datos.plataforma[f].y+datos.plataforma[f].alto;
}if(datos.desplazamientoEscenario<=datos.limiteEscenario){if(c()&&(datos.jugador_x+datos.jugador_ancho)<datos.plataforma[f].x+datos.movimientoJugador){datos.movimientoJugador=0;
datos.jugador_x=datos.plataforma[f].x-datos.jugador_ancho;}if(c()&&datos.jugador_x-datos.movimientoJugador>(datos.plataforma[f].x+datos.plataforma[f].ancho)){datos.movimientoJugador=0;
datos.jugador_x=datos.plataforma[f].x+datos.plataforma[f].ancho;}}else{if(c()&&(datos.jugador_x+datos.jugador_ancho)<datos.plataforma[f].x-datos.movimiento){datos.movimiento=0;
datos.jugador_x=datos.plataforma[f].x-datos.jugador_ancho;}if(c()&&datos.jugador_x+datos.movimiento>(datos.plataforma[f].x+datos.plataforma[f].ancho)){datos.movimiento=0;
datos.jugador_x=datos.plataforma[f].x+datos.plataforma[f].ancho;}}if(datos.salto&&datos.gravedad==0&&datos.jugador_y==datos.plataforma[f].y-datos.jugador_alto){datos.gravedad=datos.alturaSalto;
}}for(let f=0;f<datos.posMonedas.length;f++){function g(){if((datos.jugador_y+datos.jugador_alto)<datos.posMonedas[f].y){return false;}if(datos.jugador_y>(datos.posMonedas[f].y+datos.posMonedas[f].alto)){return false;
}if((datos.jugador_x+datos.jugador_ancho)<datos.posMonedas[f].x){return false;}if(datos.jugador_x>(datos.posMonedas[f].x+datos.posMonedas[f].ancho)){return false;
}return true;}g();if(g()){datos.sMonedas.play();datos.actiletMonedaColisionada=true;datos.monedaColisionada=f;datos.posicionMonedaColisionadaX=datos.posMonedas[f].x;
datos.posicionMonedaColisionadaY=datos.posMonedas[f].y;datos.posMonedas[f].x=-500;datos.posMonedas[f].y=-500;datos.contadorMonedas+=10;document.querySelector("#monedas span").innerHTML=datos.contadorMonedas;
}}for(let f=0;f<datos.posTrampas.length;f++){function n(){if((datos.jugador_y+datos.jugador_alto)<datos.posTrampas[f].y+datos.movTrampas){return false;
}if(datos.jugador_y>(datos.posTrampas[f].y+datos.movTrampas+datos.posTrampas[f].alto)){return false;}if((datos.jugador_x+datos.jugador_ancho)<datos.posTrampas[f].x){return false;
}if(datos.jugador_x>(datos.posTrampas[f].x+datos.posTrampas[f].ancho)){return false;}return true;}n();if(n()){datos.sColisionTrampasEnemigos.play();datos.sEnergia.play();
datos.imgTrampas[f].src=datos.colisionesTrampas.src;datos.imgJugador.src=datos.colision_trampa.src;datos.energia--;document.querySelector("#energia progress").value=datos.energia;
document.querySelector("#energia span").innerHTML=datos.energia+"%";if(datos.energia<=0){datos.reset=true;}}else{datos.imgTrampas[f].src=datos.trampas.src;
}}for(let f=0;f<datos.posEnemigos.length;f++){function m(){if((datos.jugador_y+datos.jugador_alto)<datos.posEnemigos[f].y){return false;}if(datos.jugador_y>(datos.posEnemigos[f].y+datos.posEnemigos[f].alto)){return false;
}if((datos.jugador_x+datos.jugador_ancho)<datos.posEnemigos[f].x){return false;}if(datos.jugador_x>(datos.posEnemigos[f].x+datos.posEnemigos[f].ancho)){return false;
}return true;}m();if(m()&&(datos.jugador_y+datos.jugador_alto)<datos.posEnemigos[f].y+datos.gravedad){datos.gravedad=0;datos.jugador_y=datos.posEnemigos[f].y-datos.jugador_alto;
}if(m()&&datos.jugador_y-datos.gravedad>(datos.posEnemigos[f].y+datos.posEnemigos[f].alto)){datos.gravedad=1;datos.jugador_y=datos.posEnemigos[f].y+datos.posEnemigos[f].alto;
}if(datos.desplazamientoEscenario<=datos.limiteEscenario){if(m()&&(datos.jugador_x+datos.jugador_ancho)<datos.posEnemigos[f].x+datos.movimientoJugador){datos.movimientoJugador=0;
datos.jugador_x=datos.posEnemigos[f].x-datos.jugador_ancho;}if(m()&&datos.jugador_x-datos.movimientoJugador>(datos.posEnemigos[f].x+datos.posEnemigos[f].ancho)){datos.movimientoJugador=0;
datos.jugador_x=datos.posEnemigos[f].x+datos.posEnemigos[f].ancho;}}else{if(m()&&(datos.jugador_x+datos.jugador_ancho)<datos.posEnemigos[f].x-datos.movimiento){datos.movimiento=0;
datos.jugador_x=datos.posEnemigos[f].x-datos.jugador_ancho;}if(m()&&datos.jugador_x+datos.movimiento>(datos.posEnemigos[f].x+datos.posEnemigos[f].ancho)){datos.movimiento=0;
datos.jugador_x=datos.posEnemigos[f].x+datos.posEnemigos[f].ancho;}}if(datos.salto&&datos.gravedad==0&&datos.jugador_y==datos.posEnemigos[f].y-datos.jugador_alto){datos.gravedad=datos.alturaSalto;
}}if(datos.cicloBalasEnemigos>=5000){datos.cicloBalasEnemigos=0;}else{datos.cicloBalasEnemigos+=20;}for(let f=0;f<=datos.cicloBalasEnemigos;f+=1000){if(datos.cicloBalasEnemigos>=f){datos.cambioBalasEnemigos=true;
datos.movBalasEnemigos=datos.velocidadBalasEnemigos;}if(datos.cicloBalasEnemigos>=f+900){datos.cambioBalasEnemigos=false;datos.movBalasEnemigos=0;}}if(datos.cambioBalasEnemigos){for(let f=0;
f<datos.posBalasEnemigos.length;f++){datos.posBalasEnemigos[f].x-=datos.movBalasEnemigos;}}else{for(let f=0;f<datos.posBalasEnemigos.length;f++){datos.posBalasEnemigos[f].x=datos.posEnemigos[f].x;
}}for(let f=0;f<datos.posBalasEnemigos.length;f++){function o(){if((datos.jugador_y+datos.jugador_alto)<datos.posBalasEnemigos[f].y){return false;}if(datos.jugador_y>(datos.posBalasEnemigos[f].y+datos.posBalasEnemigos[f].alto)){return false;
}if((datos.jugador_x+datos.jugador_ancho)<datos.posBalasEnemigos[f].x){return false;}if(datos.jugador_x>(datos.posBalasEnemigos[f].x+datos.posBalasEnemigos[f].ancho)){return false;
}return true;}o();if(o()){datos.sColisionTrampasEnemigos.play();datos.sEnergia.play();datos.energia--;document.querySelector("#energia progress").value=datos.energia;
document.querySelector("#energia span").innerHTML=datos.energia+"%";if(datos.energia<=0){datos.reset=true;}datos.imgJugador.src=datos.colision_trampa.src;
datos.imgBalasEnemigos.src=datos.colisionesBalasEnemigos.src;setTimeout(function(){datos.imgJugador.src=datos.stop_right.src;datos.direccionJugador="derecha";
datos.imgBalasEnemigos.src=datos.balasEnemigos.src;},100);}}if(datos.disparo){datos.validarDisparo=true;}if(datos.validarDisparo){if(datos.direccionJugador=="izquierda"){datos.disparoIzq=true;
datos.disparoDer=false;}else{datos.disparoIzq=false;datos.disparoDer=true;}}if(datos.disparoIzq){datos.validarDisparo=false;datos.disparo_x=datos.jugador_x+datos.movDisparoJugador;
datos.movDisparoJugador-=datos.velocidadDisparoJugador;}if(datos.disparoDer){datos.validarDisparo=false;datos.disparo_x=datos.jugador_x+datos.movDisparoJugador;
datos.movDisparoJugador+=datos.velocidadDisparoJugador;}for(let f=0;f<datos.posBalasEnemigos.length;f++){function h(){if((datos.disparo_y+datos.disparo_alto)<datos.posBalasEnemigos[f].y){return false;
}if(datos.disparo_y>(datos.posBalasEnemigos[f].y+datos.posBalasEnemigos[f].alto)){return false;}if((datos.disparo_x+datos.disparo_ancho)<datos.posBalasEnemigos[f].x){return false;
}if(datos.disparo_x>(datos.posBalasEnemigos[f].x+datos.posBalasEnemigos[f].ancho)){return false;}return true;}h();if(h()){datos.sColisionBalasEnemigo.play();
datos.imgDisparoJugador.src=datos.colisionesBalas.src;datos.posBalasEnemigos[f].x=-500;datos.posBalasEnemigos[f].y=-500;datos.disparo_ancho=50;datos.disparo_alto=50;
setTimeout(function(){datos.disparo_y=-500;},500);}}if(datos.jugador_y>500){datos.reset=true;}if(datos.reset){datos.sPerderVida.play();datos.reset=false;
datos.gravedad=0;datos.desplazamientoEscenario=0;datos.movimiento=0;datos.jugador_y=200;jugador_x=70;datos.contadorMonedas=0;document.querySelector("#monedas span").innerHTML=datos.contadorMonedas;
datos.energia=100;document.querySelector("#energia progress").value=datos.energia;document.querySelector("#energia span").innerHTML=datos.energia+"%";datos.vidas=datos.vidas-1;
if(datos.vidas==2){document.querySelector("#vidas ul li:nth-child(3)").innerHTML="X";}if(datos.vidas==1){document.querySelector("#vidas ul li:nth-child(2)").innerHTML="X";
}if(datos.vidas==0){if(datos.nivel==1){datos.sBackground01.volume=0;}if(datos.nivel==2){datos.sBackground02.volume=0;}if(datos.nivel==3){datos.sBackground03.volume=0;
}datos.sColisionTrampasEnemigos.volume=0;datos.sPerder.play();document.querySelector("#vidas ul li:nth-child(1)").innerHTML="X";document.querySelector("#gameover").style.display="block";
cancelAnimationFrame(animacion);setTimeout(function(){window.location.reload();},5000);}if(datos.nivel==1){let e=new XMLHttpRequest();e.open("GET","views/js/json/plataformasNivel1.json",true);
}if(datos.nivel==2){let e=new XMLHttpRequest();e.open("GET","views/js/json/plataformasNivel2.json",true);}if(datos.nivel==3){let e=new XMLHttpRequest();
e.open("GET","views/js/json/plataformasNivel3.json",true);}e.send();e.onreadystatechange=function(){if((e.readyState==4)&&(e.status==200)){datos.plataforma=JSON.parse(e.responseText);
}};if(datos.nivel==1){let k=new XMLHttpRequest();k.open("GET","views/js/json/monedasNivel1.json",true);}if(datos.nivel==2){let k=new XMLHttpRequest();k.open("GET","views/js/json/monedasNivel2.json",true);
}if(datos.nivel==3){let k=new XMLHttpRequest();k.open("GET","views/js/json/monedasNivel3.json",true);}k.send();k.onreadystatechange=function(){if((k.readyState==4)&&(k.status==200)){datos.posMonedas=JSON.parse(k.responseText);
for(let p=0;p<datos.posMonedas.length;p++){datos.imgMonedas[p]=new Image();datos.imgMonedas[p].src=datos.monedas.src;}}};if(datos.nivel==1){let b=new XMLHttpRequest();
b.open("GET","views/js/json/trampasNivel1.json",true);}if(datos.nivel==2){let b=new XMLHttpRequest();b.open("GET","views/js/json/trampasNivel2.json",true);
}if(datos.nivel==3){let b=new XMLHttpRequest();b.open("GET","views/js/json/trampasNivel3.json",true);}b.send();b.onreadystatechange=function(){if((b.readyState==4)&&(b.status==200)){datos.posTrampas=JSON.parse(b.responseText);
for(let p=0;p<datos.posTrampas.length;p++){datos.imgTrampas[p]=new Image();datos.imgTrampas[p].src=datos.trampas.src;}}};for(let f=1;f<=3;f++){if(datos.nivel==f){let d=new XMLHttpRequest();
d.open("GET","views/js/json/enemigosNivel"+f+".json",true);}}d.send();d.onreadystatechange=function(){if((d.readyState==4)&&(d.status==200)){datos.posEnemigos=JSON.parse(d.responseText);
datos.posBalasEnemigos=JSON.parse(d.responseText);}};}animacion=frame(juego.tiempo);if(datos.jugador_x>=950){cancelAnimationFrame(animacion);document.querySelector("#final").style.display="block";
datos.sGanar.play();if(datos.nivel==1){datos.sBackground01.pause();}if(datos.nivel==2){datos.sBackground02.pause();}if(datos.nivel==3){datos.sBackground03.pause();
}document.querySelector("#finalMonedas span").innerHTML=datos.contadorMonedas;document.querySelector("#medidaEnergiaFinal").value=datos.energia;document.querySelector("#totalEnergia").innerHTML=datos.energia+"%";
let l=100-datos.energia;document.querySelector("#puntosEnergia span").innerHTML="-"+l;let a=0;if(datos.vidas==3){a=0;}if(datos.vidas==2){a=10;document.querySelector("#final ol li:nth-child(3)").innerHTML="X";
}if(datos.vidas==1){a=20;document.querySelector("#final ol li:nth-child(2)").innerHTML="X";document.querySelector("#final ol li:nth-child(3)").innerHTML="X";
}document.querySelector("#finalVidas span").innerHTML="-"+a;datos.puntaje=datos.contadorMonedas-(l+a);datos.incrementoPuntaje=0;let j=setInterval(function(){if(datos.incrementoPuntaje>datos.puntaje){datos.incrementoPuntaje=datos.puntaje;
document.querySelector("#puntajeFinal").innerHTML=datos.puntaje;datos.sPuntos.play();datos.sMonedero.pause();clearInterval(j);setTimeout(function(){let r=new XMLHttpRequest();
let t="ok";let p=datos.puntaje;let q=datos.nivel;let s=datos.id;let i="views/ajax/usuarios.php";r.open("POST",i,true);r.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
r.send("nivel="+t+"& puntaje="+p+"& numeroNivel="+q+"& id="+s);r.onreadystatechange=function(){if((r.readyState==4)&&(r.status==200)){console.log("xhr.responseText",r.responseText);
if(r.responseText=="ok"){window.location="inicio";}}};},5000);}else{datos.incrementoPuntaje++;datos.sMonedero.play();document.querySelector("#puntajeFinal").innerHTML=datos.incrementoPuntaje;
}},16);}},salirDelJuego:function(){window.location.reload();}};